<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> ROOT入门教程 · Hexo</title><meta name="description" content="ROOT入门教程 - arlier"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="https:/arlier1.github.io/favicon.png"><link rel="stylesheet" href="https:/arlier1.github.io/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://arlier1.github.io/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="https:/arlier1.github.io/" class="logo-link"><img src="https:/arlier1.github.io/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="https:/arlier1.github.io/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https:/arlier1.github.io/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://arlier.work" target="_blank" class="nav-list-link">WORK</a></li><li class="nav-list-item"><a href="https://github.com/arlier" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://hithep.science" target="_blank" class="nav-list-link">HITHEP</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ROOT入门教程</h1><div class="post-info">Jun 24, 2016</div><div class="post-content"><p>最近在学习ROOT，发现网上有一篇不错的入门教程。从最基本的概念和用法开始介绍，非常适合入门，因此翻译出来共享一下（虽然理论上接触ROOT的人英语肯定没问题）。文章是在百度文库找到的<code>ROOT:a brief starting tutorial</code>。</p>
<h1 id="1-基础介绍"><a href="#1-基础介绍" class="headerlink" title="1.基础介绍"></a>1.基础介绍</h1><p><a href="https://root.cern.ch/" target="_blank" rel="external">ROOT</a> 是一个用于数据分析尤其是高能物理数据分析的面向对象的软件（OOF）。在面向对象的软件中有三个基础概念：类、对象和方法。类是对一个系统中某种一般性“东西”的描述，对象是类中的某一个具体的例子而方法则是类的函数。作为一个框架（framework），ROOT具有很多优点,比如更少的代码量（现有集成版本能够满足你的大多数需求，并且很稳定）和绘图、网络等服务。由于面向对象的设计ROOT允许对类进行扩展和修改来包含新的东西或者用同样的模型结构来描述实际问题的不同部分。<a id="more"></a></p>
<h2 id="面向对象的编程"><a href="#面向对象的编程" class="headerlink" title="面向对象的编程"></a>面向对象的编程</h2><p>大体上说，我们可以通过创建两个文件来定义一个类：一个声明文件（头文件或者包含文件）和一个实现文件。声明文件包含了对类的定义和公共（可以外部调用）以及私有（仅能内部使用）方法；实现文件和声明文件名字相同并以.cc为后缀，它包含了所有方法的实现步骤。例如我们可以创建一个叫“汽车”的类，它描述了汽车的一般属性四个轮子，六个档位，九个座位以及最大速度等等。从这个汽车类我们可以得到一个对象，比如一辆法拉利汽车。我们可以从头文件（例如car.h）中得到法拉利这个对象的方法。通常我们会得到一些“Get”和“Set”方法，第一个可以用来获取某个特别的信息,比如<code>GetMaxSpeed()</code>可以获得对象的最大速度，语法是<code>Ferrari.GetMaxSpeed()</code>，第二个用来设定变量的值，用户可以对头文件中的私有变量赋值。</p>
<h2 id="基本命令和指针"><a href="#基本命令和指针" class="headerlink" title="基本命令和指针"></a>基本命令和指针</h2><p>也许你知道ROOT使用CINT命令行，执行<code>.?</code>会列出所有CINT命令，<code>.x[文件名]</code>会加载和执行对应的函数，<code>.l[文件名]</code>加载文件，<code>.![shell命令]</code>执行命令等。关于指针的评述：计算机内存可以被看做连续的存储单元，计算机可以管理的最小单位是一个字节。这些单元被连续地编号并且都拥有唯一的地址。我们通过变量在内存中的地址来找到这个变量，通过符号&amp;（取址符号）我们可以找到变量的内存地址。例如B=&amp;A说明B保存的不是A的数值而是A的地址（内存编号），一个保存其他变量的地址的变量叫做指针，C++中最重要的概念之一。在上面的例子中，B指向A所以B保存着A的地址。如果我们想得到A的数值我们要用到符号C=*B,这样新的变量C就保存了B所指向的数值也就是A的数值。考虑指针直接指向对应的值，必须通过声明*name先指定这个值的数据类型（例如：double *number;）；因此当我们有一个方法并在指针上调用而不是在一般的变量上调用，必须使用语法<code>Ferrari-&gt;GetMaxSpeed()</code>而不是<code>Ferrari.GetMaxSpeed()</code>。也就是说 <code>Object.Method()</code>和 <code>PointerToAnObject-&gt;Method()</code>。</p>
<h2 id="使用ROOT"><a href="#使用ROOT" class="headerlink" title="使用ROOT"></a>使用ROOT</h2><p>有了这些一般的约定之后我们就可以开始使用ROOT了。首先我们需要安装ROOT（<a href="http://root.cern.ch/drupal/content/downloading-root" target="_blank" rel="external">下载</a>,<a href="http://root.cern.ch/root/Install.html" target="_blank" rel="external">安装说明</a>，具体信息可以参考官方手册<a href="http://root.cern.ch/drupal/content/users-guide" target="_blank" rel="external">User’s Guide</a>）。</p>
<h3 id="启动ROOT"><a href="#启动ROOT" class="headerlink" title="启动ROOT"></a>启动ROOT</h3><p><img src="http://7xsihg.com2.z0.glb.clouddn.com/root_start.png" alt="rootlanch"><br>在shell中输入<code>root</code>就可以启动ROOT，输入<code>.q</code>退出ROOT，就是这么简单啊。输入命令<code>root -l</code>可以去除开始画面。你可以把ROOT当做一个计算器使用，记得在每一行命令之后加上分号，使用上下方向键可以快速切换之前命令哦。下面是简单的例子：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">user:~$ root -l  </div><div class="line">root [<span class="number">0</span>] <span class="keyword">double</span> a=(<span class="number">3</span>*<span class="number">5</span>+<span class="number">5</span>)/<span class="number">2</span>;</div><div class="line">root [<span class="number">1</span>] <span class="built_in">cout</span>&lt;&lt;a&lt;&lt;<span class="built_in">endl</span>;</div><div class="line"><span class="number">10</span></div><div class="line">root [<span class="number">2</span>] <span class="keyword">double</span> b=a+<span class="number">2</span>;</div><div class="line">root [<span class="number">3</span>] <span class="built_in">cout</span>&lt;&lt;b&lt;&lt;<span class="built_in">endl</span>;</div><div class="line"><span class="number">12</span></div><div class="line">root [<span class="number">4</span>] a=a*<span class="number">2</span>;</div><div class="line">root [<span class="number">5</span>] <span class="built_in">cout</span>&lt;&lt;a&lt;&lt;<span class="built_in">endl</span>;</div><div class="line"><span class="number">20</span></div><div class="line">root [<span class="number">6</span>] a=a+<span class="number">5</span>;</div><div class="line">root [<span class="number">7</span>] <span class="keyword">double</span> c=<span class="built_in">sqrt</span>(a);</div><div class="line">root [<span class="number">8</span>] <span class="built_in">cout</span>&lt;&lt;c&lt;&lt;<span class="built_in">endl</span>;</div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure></p>
<p>如果你想要重置ROOT，输入：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root [<span class="number">9</span>] gROOT-Reset();</div></pre></td></tr></table></figure></p>
<p>此时输出c会提示：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root [10] cout&lt;&lt;c&lt;&lt;endl;</div><div class="line">Error: Symbol c is not defined in current scope (tmpfile)...</div></pre></td></tr></table></figure></p>
<p>正如所预料的，此时调用之前的变量就会出现错误。</p>
<h3 id="简单画图"><a href="#简单画图" class="headerlink" title="简单画图"></a>简单画图</h3><p>当然你可以在这里使用所有的标准C++命令。我们定义两个三维矢量和相应的误差矢量(为了简洁，在此之后ROOT命令的行号都被省略)，第一个是三维浮点型(浮点型意味着4个字节而double意味着8字节)的x[3]:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root [] <span class="keyword">float</span> x[<span class="number">3</span>] = &#123;<span class="number">1.0</span>, <span class="number">2.1</span>, <span class="number">3.7</span>&#125;;</div><div class="line">root [] <span class="built_in">cout</span>&lt;&lt;x[<span class="number">0</span>] &lt;&lt;<span class="string">", "</span> &lt;&lt;x[<span class="number">1</span>] &lt;&lt;<span class="string">", "</span>&lt;&lt; x[<span class="number">2</span>] &lt;&lt;<span class="built_in">endl</span>;</div><div class="line"><span class="number">1</span>, <span class="number">2.1</span>, <span class="number">3.7</span></div></pre></td></tr></table></figure></p>
<p>注意三个分量的下标是x[0],x[1],x[2]，而不是x[1],x[2],x[3]。如果我们再定义其他矢量就得到三个点和对应的误差，并画出它们：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">root [] <span class="keyword">float</span> y[<span class="number">3</span>] = &#123;<span class="number">1.1</span>,<span class="number">2.2</span>,<span class="number">4.3</span>&#125;;</div><div class="line">root [] <span class="keyword">float</span> dx[<span class="number">3</span>] = &#123;<span class="number">0.3</span>, <span class="number">0.3</span>, <span class="number">0.3</span>&#125;;</div><div class="line">root [] <span class="keyword">float</span> dy[<span class="number">3</span>] = &#123;<span class="number">3.0</span>,<span class="number">3.0</span>,<span class="number">3.0</span>&#125;;</div><div class="line">root [] <span class="function">TGraphErrors <span class="title">myfirstplot</span><span class="params">(<span class="number">3</span>,x,y,dx,dy)</span></span>;</div><div class="line">root [] myfirstplot.SetMarkerColor(<span class="number">2</span>);</div><div class="line">root [] myfirstplot.SetMarkerStyle(<span class="number">20</span>);</div><div class="line">root [] myfirstplot.SetMarkerSize(<span class="number">1.0</span>);</div><div class="line">root [] myfirstplot.Draw(<span class="string">"ap"</span>);</div><div class="line"> created <span class="keyword">default</span> TCanvas with name c1</div></pre></td></tr></table></figure></p>
<p>这时会出现一个绘图窗口，它是你产生的第一个画布，自动命名为c1，如下图所示：<br><img src="http://7xsihg.com2.z0.glb.clouddn.com/root_vecplot.png" alt="firstplot"><br>如果需要保存图片，输入<code>c1-&gt;SaveAs(&quot;myimage.eps&quot;);    SaveAs(&quot;myimage.ps&quot;);   SaveAs(&quot;myimage.gif&quot;)</code>等命令就可以。</p>
<h3 id="参数调整"><a href="#参数调整" class="headerlink" title="参数调整"></a>参数调整</h3><p>也许你已经注意到我们对输出结果的样式进行了控制。你可以通过改变这些参数来设置自己的样式。通过在画布上右击你可以看到一个菜单，并任意调整参数，比如把坐标轴变成对数形式。通过输入命令<code>myfirstplot.GetXaxis().SetTitle(&quot;X Axis&quot;);</code>就可以设置坐标轴的名称，因为TGraphErrors（当然TGraph也是）这个类有一个方法集合SetTitle()，所以一旦你通过<code>GetXaxis()</code>获得坐标轴之后就可以使用它,当然ｙ轴也是一样的。如果你对某一个类的方法不熟悉，你可以查阅你ROOT版本的<a href="http://root.cern.ch/drupal/content/reference-guide" target="_blank" rel="external">手册</a>。例如,如果你需要拟合刚才的图myfirstplot，你可以查验一下TGraphErrors类是不是有拟合的方法。如果你在ROOT5.22中寻找，你会发现“TGraphErrors is a TGraph with error bars”，所以你可以继承TGraph的所有方法。在这些方法中你可以找到Fit()，它默认进行指数拟合(Fit(“expo”))，高斯拟合(Fit(“gaus”))，或者N级多项式拟合(Fit(“polN”))。当然你可以定义自己的函数来进行数据拟合。</p>
<h3 id="二维画图"><a href="#二维画图" class="headerlink" title="二维画图"></a>二维画图</h3><p>通过类使用类TF1和TF2你可以画出任意的1维和2维函数:我们先来画$func1=\frac{\sin x}{x}$和$func2=\frac{\sin x\cdot \sin y}{x\cdot y}$。画一维函数可以使用下面的代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root [] <span class="function">TF1 <span class="title">f1</span><span class="params">(<span class="string">"func1"</span>, <span class="string">"sin(x)/x"</span>, <span class="number">0</span>, <span class="number">10</span>)</span></span>;</div><div class="line">root [] f1.Draw();</div></pre></td></tr></table></figure></p>
<p>或者<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root [] TF1 *f1 = <span class="keyword">new</span> TF1(<span class="string">"func1"</span>,<span class="string">"sin(x)/x"</span>,<span class="number">0</span>,<span class="number">10</span>);</div><div class="line">root [] f1-&gt;Draw();</div></pre></td></tr></table></figure></p>
<p>这两种方法的区别是直接定义只能在一定范围内（如某个循环）有效，在范围之外f1就不在有定义。对于画二维函数有两种方法：xy平面投影或者画出表面。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root [] TF2 *f2 = <span class="keyword">new</span> TF2(<span class="string">"func2"</span>,<span class="string">"sin(x)*sin(y)/(x*y)"</span>,<span class="number">-10</span>,<span class="number">10</span>,<span class="number">-10</span>,<span class="number">10</span>);</div><div class="line">root [] f2-&gt;Draw();</div></pre></td></tr></table></figure></p>
<p>通过选项<code>f2-&gt;Draw(&quot;surf&quot;)</code>就可以画表面图，类似的还有<code>Draw(”text”), Draw(”col”), Draw(”colz”), Draw(”box”)</code>等命令。</p>
<h3 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h3><p>使用类TH1可以画一维柱状图，你需要给出标签，标题，区间数，区间范围等参数：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function">TH1F <span class="title">h1</span><span class="params">(<span class="string">"h1"</span>,<span class="string">"h1 title"</span>,<span class="number">100</span>,<span class="number">0</span>,<span class="number">10.</span>)</span></span>;</div><div class="line">%或者使用指针</div><div class="line">TH1F *h1 = <span class="keyword">new</span> TH1F(<span class="string">"h1"</span>,<span class="string">"h1 title"</span>,<span class="number">100</span>,<span class="number">0</span>,<span class="number">10.</span>);</div></pre></td></tr></table></figure></p>
<p>例如画一个高斯型的柱状图：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root [] <span class="function">TH1F <span class="title">h1</span><span class="params">(<span class="string">"h1"</span>,<span class="string">"h1 title"</span>,<span class="number">100</span>,<span class="number">-4.</span>,<span class="number">4.</span>)</span></span>;</div><div class="line">root [] h1.FillRandom(<span class="string">"gaus"</span>,<span class="number">100000</span>);</div><div class="line">root [] h1.Draw();</div></pre></td></tr></table></figure></p>
<p>柱状图和一般图形明显不同，它需要在被声明之后有数据填充，当然填充的方法就是：<code>Fill()</code>，比如我们有一个长度为20的矢量 x[20]，通过以下循环就可以填充数据：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">root [] <span class="keyword">float</span> x[<span class="number">20</span>]=&#123;<span class="number">3.2</span>, <span class="number">1.2</span>, <span class="number">3.7</span>, <span class="number">2.3</span>, <span class="number">4.1</span>, <span class="number">1.9</span>, <span class="number">3.5</span>, <span class="number">1</span>, <span class="number">6.2</span>,<span class="number">4.4</span>, <span class="number">3.2</span>, <span class="number">4.4</span>, <span class="number">2.1</span>, <span class="number">1.1</span>, <span class="number">1.9</span>, <span class="number">6.8</span>, <span class="number">9.1</span>, <span class="number">6</span>, <span class="number">7.2</span>, <span class="number">1.9</span>&#125;;</div><div class="line">root [] <span class="function">TH1F <span class="title">h1</span><span class="params">(<span class="string">"h1"</span>,<span class="string">"h1 title"</span>,<span class="number">20</span>,<span class="number">0.</span>,<span class="number">10.</span>)</span></span>;</div><div class="line">root [] <span class="keyword">int</span> i;</div><div class="line">root [] <span class="keyword">for</span> (i=<span class="number">0</span>; i=<span class="number">19</span>; i++)</div><div class="line">        &#123;h1-Fill(x[i]);&#125;</div><div class="line">root [] h1-&gt;Draw();</div></pre></td></tr></table></figure></p>
<p>注意i的取值[0,19],而不是[0,20]。</p>
<h1 id="2-写一个脚本！"><a href="#2-写一个脚本！" class="headerlink" title="2.写一个脚本！"></a>2.写一个脚本！</h1><p>这个教程主要教会你如何使用脚本来解决问题，在详细介绍之前有必要指出ROOT可以理解你的并不完美的C++输入，典型的例子就是命令末尾的分号，如果你没加ROOT会默认ENTER的地方是一行结束。为了养成良好的习惯，我们建议严格按照C++标准语法写程序：这样当你在没有语法检测的环境中就不会忘记分号。使用.L命令就可以运行ROOT脚本。如果你想检验你的语法是不是正确的，你可以给文件名加后缀++。我们先来写一个简单的脚本：第一行需要导入库文件（通过#导入库进行预处理）。最简单的情况 #include iostream命令告诉编译器导入标准输入输出流文件。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">hello</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">  <span class="built_in">cout</span>&lt;&lt;<span class="string">"Hello everybody!!"</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>将上面的程序保存为hello.cc注意其中的<code>using namespace std;</code>标准C++库中的所有元素都要声明一个命名空间，因为在不同的命名空间你可以有相同的名字。std使用标准库在你所用的大部分原始码中都会用到；函数结束时的<code>return 0</code>，一般而言代表函数正确运行，这是通常结束一个C++控制台程序的用法。现在我们使用命令.L hello.cc++调用主函数hello<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">root [] .L hello.cc+</div><div class="line">***eventual Info messages***</div><div class="line">root [] hello()</div><div class="line">Hello everybody!!</div><div class="line">(<span class="keyword">int</span>)<span class="number">0</span></div></pre></td></tr></table></figure></p>
<p>运行成功！</p>
<p>##一个复杂一点的脚本<br>我们有一组数据需要线性拟合并得出$\chi^{2}$。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 6</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;TCanvas.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;TH1F.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;TStyle.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DataFit</span><span class="params">()</span></span></div><div class="line">&#123;   <span class="comment">//definition with initialization of the vectorsdouble</span></div><div class="line"> x[N] = &#123;<span class="number">0.2</span>, <span class="number">2.</span>, <span class="number">3.3</span>, <span class="number">4.1</span>, <span class="number">6.2</span>, <span class="number">7.</span>&#125;;</div><div class="line"><span class="keyword">double</span> y[N] = &#123;<span class="number">1.</span>, <span class="number">1.5</span>, <span class="number">1.9</span>, <span class="number">2.5</span>, <span class="number">2.7</span>, <span class="number">3.7</span>&#125;;</div><div class="line"><span class="keyword">double</span> dy[N] = &#123;<span class="number">0.4</span>, <span class="number">0.2</span>, <span class="number">0.5</span>, <span class="number">0.3</span>, <span class="number">0.9</span>, <span class="number">0.5</span>&#125;;</div><div class="line"><span class="comment">//creating the Canvas</span></div><div class="line">TCanvas *data = <span class="keyword">new</span> TCanvas(<span class="string">"Data"</span>, <span class="string">"Data"</span>, <span class="number">800</span>, <span class="number">600</span>);</div><div class="line">data-&gt;cd(<span class="number">1</span>);</div><div class="line">gStyle-&gt;SetOptStat(<span class="number">1</span>);</div><div class="line">gStyle-&gt;SetOptFit(<span class="number">11111</span>);</div><div class="line"><span class="comment">//Preparing the histogram</span></div><div class="line">TH1F* h1 = <span class="keyword">new</span> TH1F(<span class="string">"Data Fit"</span>, <span class="string">"Data Set Fit"</span>, <span class="number">15</span>, <span class="number">0.</span>, <span class="number">15.</span>)</div><div class="line"><span class="comment">//Filling the histo</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; iN; i++)</div><div class="line">    &#123;</div><div class="line">       h1-&gt;SetBinContent(h1-&gt;FindBin(x[i]),y[i]);</div><div class="line">       h1-&gt;SetBinError(h1-&gt;FindBin(x[i]),dy[i]);</div><div class="line">    &#125;</div><div class="line"><span class="comment">//Draw</span></div><div class="line">h1-&gt;Draw();</div><div class="line">h1-&gt;Fit(<span class="string">"pol1"</span>,<span class="string">"E+"</span>,<span class="string">""</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>把上面的程序保存为DataFit.cc，通常把文件名和函数名保持一致。运行程序：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">root [] .L DataFit.cc++</div><div class="line">***Info messages***</div><div class="line">root [] DataFit()FCN=<span class="number">0.98662</span></div><div class="line"> FROM MINOS STATUS=SUCCESSFUL <span class="number">22</span> CALLS <span class="number">53</span> TOTAL</div><div class="line"> EDM=<span class="number">3.94011e-23</span>  STRATEGY= <span class="number">1</span> ERROR MATRIX ACCURATE</div><div class="line"> EXT                           PARAMETER       STEP</div><div class="line">FIRSTNO. NAME     VALUE    ERROR SIZE    DERIVATIVE</div><div class="line"><span class="number">1</span> p0 <span class="number">5.96826e-01</span> <span class="number">2.89256e-01</span> <span class="number">5.18264e-09</span> <span class="number">-5.67033e-12</span></div><div class="line"><span class="number">2</span> p1 <span class="number">3.96466e-01</span> <span class="number">7.80323e-02</span> <span class="number">7.80323e-02</span> <span class="number">1.75160e-11</span></div></pre></td></tr></table></figure></p>
<p>这样我们是直接给矢量赋值，有时我们想使用外部数据，比如：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">0.2</span> <span class="number">1.</span> <span class="number">0.42</span>. <span class="number">1.5</span> <span class="number">0.23</span><span class="number">.3</span> <span class="number">1.9</span> <span class="number">0.54</span><span class="number">.1</span> <span class="number">2.5</span> <span class="number">0.36</span><span class="number">.2</span> <span class="number">2.7</span> <span class="number">0.97</span>. <span class="number">3.7</span> <span class="number">0.5</span></div></pre></td></tr></table></figure></p>
<p>假设=文件名是list.txt，常用的方法是：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;TCanvas.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;TH1F.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;TStyle.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DataFit</span><span class="params">()</span></span></div><div class="line">&#123; <span class="comment">//creating the Canvas</span></div><div class="line">  TCanvas *data = <span class="keyword">new</span> TCanvas(<span class="string">"Data"</span>, <span class="string">"Data"</span>, <span class="number">800</span>, <span class="number">600</span>);</div><div class="line">  data-&gt;cd(<span class="number">1</span>);</div><div class="line">gStyle-&gt;SetOptStat(<span class="number">1</span>);</div><div class="line">gStyle-&gt;SetOptFit(<span class="number">11111</span>);</div><div class="line"><span class="comment">//Preparing the histogram</span></div><div class="line">TH1F* h1 = <span class="keyword">new</span> TH1F(<span class="string">"Data Fit"</span>, <span class="string">"Data Set Fit"</span>, <span class="number">15</span>, <span class="number">0.</span>, <span class="number">15.</span>);</div><div class="line"><span class="comment">//Read from file and Filling the histoifstream datain</span></div><div class="line">datain.open(<span class="string">"list.txt"</span>)</div><div class="line"><span class="keyword">double</span> x, y, <span class="function">dy</span></div><div class="line"> <span class="title">while</span><span class="params">(datain&gt;&gt; x &gt;&gt; y &gt;&gt; dy)</span></div><div class="line"> &#123;</div><div class="line">   <span class="built_in">cout</span>  &lt;&lt;<span class="string">"x= "</span> &lt;&lt; x  &lt;&lt;<span class="string">" "</span> &lt;&lt;<span class="string">"y= "</span> &lt;&lt; y  &lt;&lt;<span class="string">" "</span> &lt;&lt;<span class="string">"sigmay= "</span>&lt;&lt;  dy &lt;&lt;<span class="built_in">endl</span>;</div><div class="line">   h1-&gt;SetBinContent(h1-&gt;FindBin(x), y);</div><div class="line">   h1-&gt;SetBinError(h1-&gt;FindBin(x), dy)</div><div class="line"> &#125;</div><div class="line">datain.close();</div><div class="line"><span class="comment">//Draw</span></div><div class="line">h1-&gt;Draw();</div><div class="line">h1-&gt;Fit(<span class="string">"pol1"</span>,<span class="string">"E+"</span>,<span class="string">""</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>我们用流的数据来填充柱状图，并使用了cout(最好让数据文件和DataFit.cc处于同一个文件夹内)，现在屏幕显示：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">root [] DataFit()</div><div class="line">x= <span class="number">0.2</span> y= <span class="number">1</span> sigmay= <span class="number">0.4</span></div><div class="line">x= <span class="number">2</span> y= <span class="number">1.5</span> sigmay= <span class="number">0.2</span></div><div class="line">x= <span class="number">3.3</span> y= <span class="number">1.9</span> sigmay= <span class="number">0.5</span></div><div class="line">x= <span class="number">4.1</span> y= <span class="number">2.5</span> sigmay= <span class="number">0.3</span></div><div class="line">x= <span class="number">6.2</span> y= <span class="number">2.7</span> sigmay= <span class="number">0.9</span></div><div class="line">x= <span class="number">7</span> y= <span class="number">3.7</span> sigmay= <span class="number">0.5</span></div><div class="line">FCN=<span class="number">0.98662</span>   FROM MINOS   STATUS=SUCCESSFUL <span class="number">24</span>  CALLS <span class="number">66</span>   TOTAL</div><div class="line">EDM=<span class="number">2.32486e-21</span> STRATEGY= <span class="number">1</span>   ERROR MATRIX ACCURATE</div><div class="line">EXT PARAMETER              STEP   FIRST</div><div class="line">NO.   NAME     VALUE    ERROR   SIZE   DERIVATIVE</div><div class="line"><span class="number">1</span> p0 <span class="number">5.96826e-01</span> <span class="number">2.89256e-01</span> <span class="number">-2.80463e-08</span> <span class="number">1.22857e-11</span></div><div class="line"><span class="number">2</span> p1 <span class="number">3.96466e-01</span> <span class="number">7.80324e-02</span> <span class="number">7.80324e-02</span> <span class="number">3.50320e-12</span></div></pre></td></tr></table></figure></p>
<p>可以看到即使我们没有在图中填充x方向误差，x误差bar还是出现了，这是由于bin区间带来的统计误差。TH1中有15bin，如果我们增加bin的数目(比如用1000个bin)，误差就很小了，这样做会影响到拟合参数以及$\chi^{2}$的值。<br>文章来源：ROOT:a brief starting tutorial 作者：P. Oliva July 13, 2009</p>
</div></article></div></main><footer><div class="paginator"><a href="https:/arlier1.github.io/2016/06/23/hexoblog/" class="prev">PREV</a><a href="https:/arlier1.github.io/2016/06/24/MIT的学术评价体系by文小刚/" class="next">NEXT</a></div><div class="copyright"><p>© 2016 - 2017 <a href="https://arlier1.github.io">arlier</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>